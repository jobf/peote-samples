<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>../../pages/http/_starter</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		* {
			margin: 0;
			padding: 0
		}

		body {
			background-color: #fff;
			color: #001742;
			font-family: Arial, Helvetica, sans-serif;
			margin: 5px;
		}
	</style>

	
	<link rel="stylesheet" href="../../_scripts/highlightjs/styles/github-dark.min.css">
	
</head>

<body>
	
	<iframe src="html5/bin/index.html" width="800" height="600"></iframe>
<h1>http/_starter/</h1>
<p></p>
<pre>
	<code class="language-haxe">
package;

import lime.app.Application;
import lime.ui.Window;

import peote.view.PeoteView;
import peote.view.Color;

import peote.text.Font;

import peote.ui.PeoteUIDisplay;
import peote.ui.interactive.UITextLine;
import peote.ui.interactive.UITextPage;
import peote.ui.event.PointerEvent;
import peote.ui.style.BoxStyle;
import peote.ui.style.TextStyle;
import peote.ui.style.interfaces.FontStyle;

// ------------------------------------------
// --- using a custom FontStyle here --------
// ------------------------------------------

@packed // this is need for ttfcompile fonts (gl3font)
@globalLineSpace // all pageLines using the same page.lineSpace (gap to next line into page)
@:structInit
class MyFontStyle implements FontStyle
{
	public var color:Color = Color.GREEN;
	public var width:Float = 38; // (<- is it still fixed to get from font-defaults if this is MISSING ?)
	public var height:Float = 36;
	@global public var weight = 0.5; //0.49 <- more thick (only for ttfcompiled fonts)
}

// -----------------------------------
// -------- main code starts ---------
// -----------------------------------

class Main extends Application
{
	var peoteView:PeoteView;
	var uiDisplay:PeoteUIDisplay;
	
	
	// L I M E - initializing
	
	override function onWindowCreate():Void
	{
		switch (window.context.type)
		{
			case WEBGL, OPENGL, OPENGLES:
				try startSample(window)
				catch (_) trace(haxe.CallStack.toString(haxe.CallStack.exceptionStack()), _);
			default: throw("Sorry, only works with OpenGL.");
		}
	}

	// ---------------------------------------------------------------------------
	// --- before starting PeoteUIDisplay, it have to load the fonts at first  ---
	// ---------------------------------------------------------------------------

	public function startSample(window:Window)
	{
		new Font<MyFontStyle>("assets/fonts/packed/hack/config.json").load( onFontLoaded );
	}
	
	// ----------------------------------------------
	// ------ OK, we are READY at now (^_^)  --------
	// ----------------------------------------------

	public function onFontLoaded(font:Font<MyFontStyle>) // don'T forget argument-type here !
	{					
		peoteView = new PeoteView(window);
		uiDisplay = new PeoteUIDisplay(20, 20, 1768, 1200, Color.BLACK + 0x0a030100);
		peoteView.addDisplay(uiDisplay);		
		
		
		// ----------------------
		// ------ Styles --------
		// ----------------------
				
		var fontStyle = new MyFontStyle();		
		var fontStyleInput = new MyFontStyle();
		fontStyleInput.color = Color.GREY5;
		
		var boxStyle  = new BoxStyle(Color.BLACK);		

		var textStyle:TextStyle = {
			backgroundStyle:boxStyle,
			selectionStyle:BoxStyle.createById(1, Color.GREY3),
			cursorStyle:BoxStyle.createById(2, Color.RED)
		}
		
		
		// ----------------------
		// ------ TOKEN --------
		// ----------------------
				
		var token = new UITextLine<MyFontStyle>(0, 0, {width:720}, "<token-input>", font, fontStyleInput, textStyle);

		// set events
		token.onPointerDown = function(t:UITextLine<MyFontStyle>, e:PointerEvent) {
			t.setInputFocus(e);
			t.startSelection(e);
		}
		token.onPointerUp = function(t:UITextLine<MyFontStyle>, e:PointerEvent) {
			t.stopSelection(e);
		}
		uiDisplay.add(token);
		
		
		// ----------------------
		// ------- INPUT --------
		// ----------------------
				
		var input = new UITextLine<MyFontStyle>(0, 50, {width:720}, "<user-input>", font, fontStyleInput, textStyle);

		// set events
		input.onPointerDown = function(t:UITextLine<MyFontStyle>, e:PointerEvent) {
			t.setInputFocus(e);
			t.startSelection(e);
		}
		input.onPointerUp = function(t:UITextLine<MyFontStyle>, e:PointerEvent) {
			t.stopSelection(e);
		}
		uiDisplay.add(input);
		
		
		// ----------------------
		// ------ OUTPUT --------
		// ----------------------

		var textPage = new UITextPage<MyFontStyle>(0, 112, "OUTPUT\nBY\nSOCKET-SERVICE (HTTP!)", font, fontStyle);
		
		// set events
		textPage.onPointerOver = function(t:UITextPage<MyFontStyle>, e:PointerEvent) {
			t.fontStyle.color = Color.YELLOW;
			t.updateStyle();
		}
		textPage.onPointerOut = function(t:UITextPage<MyFontStyle>, e:PointerEvent) {
			t.fontStyle.color = Color.GREEN;
			t.updateStyle();
		}
		
		uiDisplay.add(textPage);			

	
		
		// ------------------------------------------------------------
		// ------------------------------------------------------------
		// ------------------------------------------------------------
		
		#if android
		uiDisplay.mouseEnabled = false;
		peoteView.zoom = 3;
		#end
		
		// TODO: set what events to register (mouse, touch, keyboard ...)
		PeoteUIDisplay.registerEvents(window);
	}
	
}

	</code>
</pre>

</body>



<script type="module">
	import hljs from '../../_scripts/highlightjs/es/core.min.js'
	import haxe from '../../_scripts/highlightjs/es/languages/haxe.min.js';
	hljs.registerLanguage('haxe', haxe);
	hljs.highlightAll();
</script>


</html>